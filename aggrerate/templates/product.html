{% extends "layout.html" %}
{% block body %}
<div class="product">
    <h2>{{ product.manufacturer }} {{ product.name }} <a href="{{ url_for('edit_product', product_id=product.id) }}" class="btn btn-small"><i class="icon-edit"></i></a></h2>

    <div class="row">
        <div class="scraped_reviews span6">
            <h3>Scraped Reviews</h3>
            {% for review in scraped_reviews %}
                <div class="review">
                    <h4>{{ review.source_name }} says <a href="{{ review.url }}" title="Original review">{{ review.score }}</a></h4>
                    {{ review.blurb | markdown }}
                </div>
            {% endfor %}
        </div>

        <div class="user_reviews span6">
            <h3>User Reviews</h3>
            {% for review in user_reviews %}
                <div class="review">
                    <h4>
                        <a class="close" href="{{ url_for('delete_review', product_id=product.id, review_id=review.id) }}">&times;</a>
                        Review by {{ review.username }}: {{ review.score }}
                    </h4>
                    {{ review.body_text | markdown }}
                </div>
            {% endfor %}
        </div>
    </div>

    <div class="row">
        <div class="span6">
            <form name="f1" action="{{ url_for('scrape') }}" method="post" class="form-horizontal">
                <fieldset>
                    <legend>Trigger a scrape</legend>

                    <div class="control-group">
                        <label for="url" class="control-label">URL</label>
                        <div class="controls">
                            <input name="url" type="text" class="input-large">
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn">Scrape</button>
                    </div>

                    <input type="hidden" name="product_id" value="{{ product.id }}">
                </fieldset>
            </form>
        </div>

        <div class="span6">
            <form name="f2" action="{{ url_for('post_product_review', product_id=product.id) }}" method="post" class="form-horizontal">
                <fieldset>
                    <legend>Write a review</legend>

                    <div class="control-group">
                        <label for="score" class="control-label">Score</label>
                        <div class="controls">
                            <input name="score" type="number" min="0" max="10" step="1" value="10" class="input-mini">
                        </div>
                    </div>

                    <div class="control-group">
                        <label for="reviewText" class="control-label">Review</label>
                        <div class="controls">
                            <textarea name="reviewText" rows="20" class="input-xlarge"></textarea>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn">Post</button>
                    </div>
                </fieldset>
            </form>
        </div>
    </div>
</div>
{% endblock %}
